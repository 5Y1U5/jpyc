<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JPYCæŠ•ã’éŠ­ã‚·ã‚¹ãƒ†ãƒ </title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        .animate-spin {
            animation: spin 1s linear infinite;
        }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="module">
        import React from 'https://esm.sh/react@18.2.0';
        import ReactDOM from 'https://esm.sh/react-dom@18.2.0/client';
        import { useState, useEffect } from 'https://esm.sh/react@18.2.0';
        
        // Generator Page Component
        function GeneratorPage() {
            const [name, setName] = useState('');
            const [address, setAddress] = useState('');
            const [avatarUrl, setAvatarUrl] = useState('');
            const [embedCode, setEmbedCode] = useState('');
            const [directUrl, setDirectUrl] = useState('');
            const [shortUrl, setShortUrl] = useState('');
            const [qrCodeUrl, setQrCodeUrl] = useState('');
            
            const handleAvatarUrlChange = (e) => {
                const url = e.target.value;
                setAvatarUrl(url);
            };
            
            const generateCode = () => {
                if (!name || !address) {
                    alert('è¡¨ç¤ºåã¨ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
                    return;
                }
                
                const baseUrl = window.location.origin;
                
                // Create short parameters using base64 encoding
                // Include avatar URL if available
                const shortData = btoa(JSON.stringify({ 
                    n: name, 
                    a: address, 
                    img: avatarUrl || null 
                }));
                
                const tipUrl = baseUrl + '/tip.html?d=' + shortData;
                
                const iframe = '<iframe src="' + tipUrl + '" width="100%" height="600" style="border: none; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);"></iframe>';
                
                // Generate QR code using the direct URL
                const qrUrl = 'https://api.qrserver.com/v1/create-qr-code/?size=300x300&data=' + encodeURIComponent(tipUrl);
                
                setEmbedCode(iframe);
                setDirectUrl(tipUrl);
                setShortUrl(tipUrl); // Use the same URL for "short" URL
                setQrCodeUrl(qrUrl);
            };
            
            const copyToClipboard = (text) => {
                navigator.clipboard.writeText(text).then(() => {
                    alert('ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ');
                });
            };
            
            const downloadQR = () => {
                const link = document.createElement('a');
                link.href = qrCodeUrl;
                link.download = 'jpyc-tip-qr-' + name + '.png';
                link.click();
            };
            
            return React.createElement('div', { className: 'min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 py-12 px-4' },
                React.createElement('div', { className: 'max-w-4xl mx-auto space-y-8' },
                    // Header
                    React.createElement('div', { className: 'text-center space-y-4' },
                        React.createElement('h1', { className: 'text-4xl font-bold bg-gradient-to-r from-cyan-600 to-blue-600 bg-clip-text text-transparent' },
                            'ğŸ’¸ JPYCæŠ•ã’éŠ­ã‚·ã‚¹ãƒ†ãƒ '
                        ),
                        React.createElement('p', { className: 'text-gray-600 text-lg' },
                            'æš—å·è³‡ç”£ã§ç°¡å˜ã«æŠ•ã’éŠ­ã‚’å—ã‘å–ã‚Œã‚‹åŸ‹ã‚è¾¼ã¿ã‚³ãƒ¼ãƒ‰ã‚’ç”Ÿæˆ'
                        )
                    ),
                    
                    // Input Form
                    React.createElement('div', { className: 'bg-white rounded-lg shadow-sm border p-6 space-y-6' },
                        React.createElement('div', null,
                            React.createElement('h2', { className: 'text-2xl font-semibold mb-2' }, 'å—å–äººæƒ…å ±ã®å…¥åŠ›'),
                            React.createElement('p', { className: 'text-sm text-gray-500' }, 'æŠ•ã’éŠ­ã‚’å—ã‘å–ã‚‹æ–¹ã®æƒ…å ±ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„')
                        ),
                        
                        // Name Input
                        React.createElement('div', { className: 'space-y-2' },
                            React.createElement('label', { className: 'text-sm font-medium' },
                                'è¡¨ç¤ºå ',
                                React.createElement('span', { className: 'text-red-500' }, '*')
                            ),
                            React.createElement('input', {
                                type: 'text',
                                placeholder: 'ä¾‹: ã‚¯ãƒªã‚¨ã‚¤ã‚¿ãƒ¼å¤ªéƒ',
                                value: name,
                                onChange: (e) => setName(e.target.value),
                                maxLength: 50,
                                className: 'flex h-10 w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500'
                            }),
                            React.createElement('p', { className: 'text-xs text-gray-500' },
                                'æŠ•ã’éŠ­ãƒšãƒ¼ã‚¸ã«è¡¨ç¤ºã•ã‚Œã‚‹åå‰ï¼ˆæœ€å¤§50æ–‡å­—ï¼‰'
                            )
                        ),
                        
                        // Address Input
                        React.createElement('div', { className: 'space-y-2' },
                            React.createElement('label', { className: 'text-sm font-medium' },
                                'ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã‚¢ãƒ‰ãƒ¬ã‚¹ ',
                                React.createElement('span', { className: 'text-red-500' }, '*')
                            ),
                            React.createElement('input', {
                                type: 'text',
                                placeholder: '0x...',
                                value: address,
                                onChange: (e) => setAddress(e.target.value),
                                className: 'flex h-10 w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm font-mono focus:outline-none focus:ring-2 focus:ring-blue-500'
                            }),
                            React.createElement('p', { className: 'text-xs text-gray-500' },
                                'Polygon Mainnetã®ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã‚¢ãƒ‰ãƒ¬ã‚¹'
                            )
                        ),
                        
                        // Avatar URL Input
                        React.createElement('div', { className: 'space-y-2' },
                            React.createElement('label', { className: 'text-sm font-medium' }, 'ã‚¢ãƒã‚¿ãƒ¼ç”»åƒURLï¼ˆä»»æ„ï¼‰'),
                            React.createElement('input', {
                                type: 'url',
                                placeholder: 'https://example.com/avatar.jpg',
                                value: avatarUrl,
                                onChange: handleAvatarUrlChange,
                                className: 'flex h-10 w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500'
                            }),
                            avatarUrl && React.createElement('div', { className: 'flex items-center gap-3' },
                                React.createElement('img', {
                                    src: avatarUrl,
                                    alt: 'Preview',
                                    className: 'w-16 h-16 rounded-full object-cover border-2 border-gray-200',
                                    onError: (e) => { e.target.style.display = 'none'; }
                                }),
                                React.createElement('p', { className: 'text-xs text-green-600' }, 'âœ“ ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è¡¨ç¤º')
                            ),
                            React.createElement('p', { className: 'text-xs text-gray-500' },
                                'ç”»åƒãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°ã‚µãƒ¼ãƒ“ã‚¹ï¼ˆimgur.comã€Gravatarç­‰ï¼‰ã®URLã‚’å…¥åŠ›'
                            )
                        ),
                        
                        // Generate Button
                        React.createElement('button', {
                            onClick: generateCode,
                            className: 'w-full h-11 px-8 rounded-md bg-cyan-600 text-white font-medium hover:bg-cyan-700 transition-colors shadow-md'
                        }, 'ğŸš€ åŸ‹ã‚è¾¼ã¿ã‚³ãƒ¼ãƒ‰ã‚’ç”Ÿæˆ')
                    ),
                    
                    // Generated Code
                    embedCode && React.createElement('div', { className: 'bg-white rounded-lg shadow-sm border p-6 space-y-6' },
                        React.createElement('div', null,
                            React.createElement('h2', { className: 'text-2xl font-semibold mb-2' }, 'ç”Ÿæˆã•ã‚ŒãŸåŸ‹ã‚è¾¼ã¿ã‚³ãƒ¼ãƒ‰'),
                            React.createElement('p', { className: 'text-sm text-gray-500' }, 'ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚’Webã‚µã‚¤ãƒˆã«è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„')
                        ),
                        
                        // Embed Code
                        React.createElement('div', { className: 'space-y-2' },
                            React.createElement('div', { className: 'flex items-center justify-between mb-2' },
                                React.createElement('label', { className: 'text-sm font-medium' }, 'åŸ‹ã‚è¾¼ã¿ã‚³ãƒ¼ãƒ‰ï¼ˆiframeï¼‰'),
                                React.createElement('button', {
                                    onClick: () => copyToClipboard(embedCode),
                                    className: 'px-3 py-1 text-sm rounded-md border border-gray-300 hover:bg-gray-50'
                                }, 'ã‚³ãƒ”ãƒ¼')
                            ),
                            React.createElement('textarea', {
                                readOnly: true,
                                value: embedCode,
                                className: 'w-full h-24 p-3 text-sm font-mono bg-gray-50 border border-gray-200 rounded-md resize-none'
                            })
                        ),
                        
                        // Direct URL
                        React.createElement('div', { className: 'space-y-2' },
                            React.createElement('div', { className: 'flex items-center justify-between mb-2' },
                                React.createElement('label', { className: 'text-sm font-medium' }, 'ãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆURL'),
                                React.createElement('div', { className: 'flex gap-2' },
                                    React.createElement('button', {
                                        onClick: () => window.open(directUrl, '_blank'),
                                        className: 'px-3 py-1 text-sm rounded-md border border-gray-300 hover:bg-gray-50'
                                    }, 'ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼'),
                                    React.createElement('button', {
                                        onClick: () => copyToClipboard(directUrl),
                                        className: 'px-3 py-1 text-sm rounded-md border border-gray-300 hover:bg-gray-50'
                                    }, 'ã‚³ãƒ”ãƒ¼')
                                )
                            ),
                            React.createElement('input', {
                                readOnly: true,
                                value: directUrl,
                                className: 'w-full h-10 px-3 py-2 text-sm font-mono bg-gray-50 border border-gray-200 rounded-md'
                            })
                        ),
                        
                        // Share URL
                        React.createElement('div', { className: 'space-y-2' },
                            React.createElement('div', { className: 'flex items-center justify-between mb-2' },
                                React.createElement('label', { className: 'text-sm font-medium' }, 
                                    'å…±æœ‰ç”¨URL ',
                                    React.createElement('span', { className: 'px-2 py-0.5 text-xs bg-green-100 text-green-700 rounded font-normal' }, 'æ¨å¥¨')
                                ),
                                React.createElement('div', { className: 'flex gap-2' },
                                    React.createElement('button', {
                                        onClick: () => window.open(shortUrl, '_blank'),
                                        className: 'px-3 py-1 text-sm rounded-md border border-gray-300 hover:bg-gray-50'
                                    }, 'ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼'),
                                    React.createElement('button', {
                                        onClick: () => copyToClipboard(shortUrl),
                                        className: 'px-3 py-1 text-sm rounded-md bg-cyan-600 text-white hover:bg-cyan-700 shadow-sm'
                                    }, 'ã‚³ãƒ”ãƒ¼')
                                )
                            ),
                            React.createElement('input', {
                                readOnly: true,
                                value: shortUrl,
                                className: 'w-full h-10 px-3 py-2 text-sm font-mono bg-green-50 border border-green-300 rounded-md font-semibold'
                            }),
                            React.createElement('p', { className: 'text-xs text-gray-500' }, 
                                'âœ¨ SNSå…±æœ‰ã‚„QRã‚³ãƒ¼ãƒ‰ã«æœ€é©ãªURLï¼ˆã‚³ãƒ³ãƒ‘ã‚¯ãƒˆãªbase64å½¢å¼ï¼‰'
                            )
                        ),
                        
                        // QR Code
                        React.createElement('div', { className: 'space-y-2' },
                            React.createElement('div', { className: 'flex items-center justify-between mb-2' },
                                React.createElement('label', { className: 'text-sm font-medium' }, 'QRã‚³ãƒ¼ãƒ‰'),
                                React.createElement('button', {
                                    onClick: downloadQR,
                                    className: 'px-3 py-1 text-sm rounded-md border border-gray-300 hover:bg-gray-50'
                                }, 'ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰')
                            ),
                            React.createElement('div', { className: 'flex justify-center p-4 bg-white border border-gray-200 rounded-lg' },
                                React.createElement('img', {
                                    src: qrCodeUrl,
                                    alt: 'QR Code',
                                    className: 'w-48 h-48'
                                })
                            ),
                            React.createElement('p', { className: 'text-xs text-gray-500 text-center' }, 
                                'ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³ã§èª­ã¿å–ã‚‹ã¨æŠ•ã’éŠ­ãƒšãƒ¼ã‚¸ã‚’é–‹ã‘ã¾ã™'
                            )
                        )
                    )
                )
            );
        }
        
        // Render App
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(React.createElement(GeneratorPage));
    </script>
</body>
</html>
